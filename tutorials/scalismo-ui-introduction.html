<html><head><title>scalismo: Visualizing with Scalismo-ui</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Gravis Group, University of Basel" /><meta name="description" content="Scalismo - Scalable Image Analysis and Shape Modelling " /><meta name="og:image" content="/scalismo-microsite/img/poster.png" /><meta name="image" property="og:image" content="/scalismo-microsite/img/poster.png" /><meta name="og:title" content="scalismo: Visualizing with Scalismo-ui" /><meta name="title" property="og:title" content="scalismo: Visualizing with Scalismo-ui" /><meta name="og:site_name" content="scalismo" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Scalismo - Scalable Image Analysis and Shape Modelling " /><link rel="icon" type="image/png" href="/scalismo-microsite/img/favicon.png" /><meta name="twitter:title" content="scalismo: Visualizing with Scalismo-ui" /><meta name="twitter:image" content="/scalismo-microsite/img/poster.png" /><meta name="twitter:description" content="Scalismo - Scalable Image Analysis and Shape Modelling " /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/scalismo-microsite/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scalismo-microsite/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scalismo-microsite/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scalismo-microsite/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scalismo-microsite/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scalismo-microsite/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scalismo-microsite/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scalismo-microsite/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scalismo-microsite/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scalismo-microsite/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scalismo-microsite/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scalismo-microsite/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scalismo-microsite/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scalismo-microsite/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scalismo-microsite/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scalismo-microsite/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scalismo-microsite/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scalismo-microsite/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scalismo-microsite/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scalismo-microsite/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scalismo-microsite/highlight/styles/default.css" /><link rel="stylesheet" href="/scalismo-microsite/css/style.css" /><link rel="stylesheet" href="/scalismo-microsite/css/palette.css" /><link rel="stylesheet" href="/scalismo-microsite/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scalismo-microsite/" class="brand"><div class="brand-wrapper"><span>scalismo</span></div></a></li> <li><a href="/scalismo-microsite/tutorials/tutorial1.html" class="">Hello Scalismo</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial2.html" class="">Rigid alignment</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial3.html" class="">From meshes to deformation fields</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial4.html" class="">Gaussian processes and Point Distribution Models</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial5.html" class="">Gaussian processes, sampling and marginalization</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial6.html" class="">Building a shape model from data</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial7.html" class="">Gaussian processes and kernels</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial8.html" class="">Posterior Shape Models</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial9.html" class="">Shape completion</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial10.html" class="">ICP for rigid alignment</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial11.html" class="">Model fitting with ICP</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial12.html" class="">Parametric, non-rigid registration</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial13.html" class="">Active Shape Models</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial14.html" class="">Model fitting using MCMC - The basic framework</a></li> <li><a href="/scalismo-microsite/tutorials/tutorial14.html" class="">Model fitting using MCMC - Fitting a shape model</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/unibas-gravis/scalismo"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/unibas-gravis/scalismo"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('scalismo Scalismo - Scalable Image Analysis and Shape Modelling ');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('scalismo Scalismo - Scalable Image Analysis and Shape Modelling ');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="unibas-gravis" data-github-repo="scalismo-microsite"><div class="content-wrapper"><section><h1 id="introduction-to-scalismo-ui">Introduction to Scalismo-ui</h1>

<p>The goal of this tutorial is to give a practical introduction to visualizing with
<em>Scalismo-ui</em>.</p>

<p>To get it out of the way, we import the following:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// api functions for scalismo-ui
</span><span class="k">import</span> <span class="nn">scalismo.ui.api._</span>

<span class="c1">// some objects and readers from scalismo
</span><span class="k">import</span> <span class="nn">scalismo.io._</span>
<span class="k">import</span> <span class="nn">scalismo.geometry._</span>
<span class="k">import</span> <span class="nn">scalismo.registration._</span>

<span class="c1">// some other things needed in the examples
</span><span class="k">import</span> <span class="nn">java.io.File</span>
<span class="k">import</span> <span class="nn">java.awt.Color</span>
<span class="k">import</span> <span class="nn">breeze.linalg.DenseVector</span>
<span class="k">import</span> <span class="nn">breeze.stats.distributions.Gaussian</span>

</code></pre></div></div>

<h2 id="starting-scalismo-ui-and-creating-groups">Starting Scalismo-ui and creating groups</h2>

<p>The first step is to create a <code class="highlighter-rouge">ui</code> object, with which we interact. This can be done by calling</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">ui</span> <span class="k">=</span> <span class="nc">ScalismoUI</span><span class="o">()</span>
</code></pre></div></div>

<p>You will see that this starts the graphical user interface. Scalismo-ui features different perspectives on the data. In this guide we use the orthogonal view, which you can select from the menu <code class="highlighter-rouge">View-&gt;Perspective-&gt;Orthognonal Slices</code>. You should now see the following window:
<img src="images/scalismo-ui-empty.png" alt="Clicking landmarks" /></p>

<p>Before we can start visualizing objects, we need to create a group. A group is a collection of objects that belong together. A typical scenario is that we have an 3D image of a structure, but also a segmentation given in form of a surface mesh and maybe even some manually annotated landmark points. A group is created by calling</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">group</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">createGroup</span><span class="o">(</span><span class="s">"object-1"</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="visualizing-objects">Visualizing objects</h2>

<p>We start by loading a mesh using Scalismo:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">mesh</span> <span class="k">=</span> <span class="nc">MeshIO</span><span class="o">.</span><span class="n">readMesh</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">File</span><span class="o">(</span><span class="s">"./datasets/Paola.stl"</span><span class="o">)).</span><span class="n">get</span>
</code></pre></div></div>

<p>To visualize any scalismo object, we use the show method. As a first argument
we specify the group to which the objects belongs and the last argument is an identifier:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">meshView</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">group</span><span class="o">,</span> <span class="n">mesh</span><span class="o">,</span> <span class="s">"mesh"</span><span class="o">)</span>
</code></pre></div></div>

<p>This call shows the mesh and returns a <code class="highlighter-rouge">view</code> object, which we can use to
interact with the visualization. For example we can change the color or the opacity</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">meshView</span><span class="o">.</span><span class="n">color</span> <span class="k">=</span> <span class="nc">Color</span><span class="o">.</span><span class="nc">RED</span>
<span class="n">meshView</span><span class="o">.</span><span class="n">opacity</span> <span class="k">=</span> <span class="mf">1.0</span>
</code></pre></div></div>

<p>We can also change the visibility of an object, and for example show it only in the
3D viewport, but not the slice views. This is done by calling</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ui</span><span class="o">.</span><span class="n">setVisibility</span><span class="o">(</span><span class="n">meshView</span><span class="o">,</span> <span class="nc">Viewport</span><span class="o">.</span><span class="n">_3dOnly</span><span class="o">)</span>
</code></pre></div></div>

<p>To show it again in all viewports we call</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ui</span><span class="o">.</span><span class="n">setVisibility</span><span class="o">(</span><span class="n">meshView</span><span class="o">,</span> <span class="nc">Viewport</span><span class="o">.</span><span class="n">all</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="finding-object-views">Finding object views</h2>

<p>We have seen that to interact with an object we need a view of that object. When we use the <code class="highlighter-rouge">show</code> method to visualize the object, we directly obtain the corresponding view. However, sometimes an object is created by the user, using the graphical user interface. A typical use case is that the user clicks landmarks on an object. In Scalismo-ui, landmarks can be defined by selecting the landmarking button in the top-left corner of the toolbar and  left-clicking on the object.
<img src="images/landmarking.png" alt="Clicking landmarks" /></p>

<p>To work with the clicked landmarks, we need to obtain the corresponding views. This can be done using the filter method of the ui. This method is very similarly to a filter method of the Scala collections. It goes through all the objects in a group and returns a list of the object with the correct type that satisfy a given predicate. The view for the clicked landmarks can be obtained as follows:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">landmarkViews</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">filter</span><span class="o">[</span><span class="kt">LandmarkView</span><span class="o">](</span><span class="n">group</span><span class="o">,</span> <span class="o">(</span><span class="n">v</span> <span class="k">:</span> <span class="kt">LandmarkView</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="kc">true</span><span class="o">)</span>
</code></pre></div></div>

<p>Exactly in the same way as we manipulated the display properties of the mesh, we can now change the properties of the landmarks using these views. We can also access the underlying
scalismo object and, for example, print out their point coordinates.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="o">(</span><span class="n">landmarkView</span> <span class="k">&lt;-</span> <span class="n">landmarkViews</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">landmarkView</span><span class="o">.</span><span class="n">color</span> <span class="k">=</span> <span class="nc">Color</span><span class="o">.</span><span class="nc">RED</span>
  <span class="n">println</span><span class="o">(</span><span class="n">landmarkView</span><span class="o">.</span><span class="n">landmark</span><span class="o">.</span><span class="n">point</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="adding-transformations">Adding transformations</h2>

<p>Scalismo-ui does not only allow us to visualize static objects, but can also be used
to visualize transformations and deformations of the objects in a group. This can be achieved
by adding a transformation to the group; i.e. a function that maps every 3D point in the scene to another 3D point. The following example flips the objects in the group along the y axis.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">transformationView</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">addTransformation</span><span class="o">(</span><span class="n">group</span><span class="o">,</span> <span class="nc">Transformation</span><span class="o">((</span><span class="n">p</span> <span class="k">:</span> <span class="kt">Point</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="nc">Point3D</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="o">)),</span> <span class="s">"flip"</span><span class="o">)</span>
</code></pre></div></div>

<p>Note that this does not only turn the mesh upside down, but also the landmarks. This is a general rule: a transformation is always applied to all objects in the group.
To get back the original mesh, we simply remove the transformation by calling:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">transformationView</span><span class="o">.</span><span class="n">remove</span><span class="o">()</span>
</code></pre></div></div>

<p>Once we are done with the visualization, we can remove the entire group using</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">group</span><span class="o">.</span><span class="n">remove</span><span class="o">()</span>
</code></pre></div></div>

<h2 id="visualizing-statistical-shape-models">Visualizing Statistical Shape Models</h2>

<p>One of the important use cases that guided the development of scalismo-ui is the
visualization of statistical shape models. A statistical shape model is
just a mesh that is transformed by a parametric family of transformation.
Letâ€™s load a statistical shape model and visualize it:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">ssm</span> <span class="k">=</span> <span class="nc">StatismoIO</span><span class="o">.</span><span class="n">readStatismoMeshModel</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"datasets/bfm.h5"</span><span class="o">)).</span><span class="n">get</span>
<span class="k">val</span> <span class="n">ssmGroup</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">createGroup</span><span class="o">(</span><span class="s">"shape-model"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">ssmView</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">ssmGroup</span><span class="o">,</span> <span class="n">ssm</span><span class="o">,</span> <span class="s">"ssm"</span><span class="o">)</span>
</code></pre></div></div>

<p>In scalismo-ui, a statistical shape model is represented as a mesh together with two
transformations:  one (rigid) transformation that controls the pose of the mesh and
one that controls the actual shape. We can access the individual parts of an ssm using
the <code class="highlighter-rouge">ssmView</code> object.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">ssmView</span><span class="o">.</span><span class="n">meshView</span>
 <span class="n">ssmView</span><span class="o">.</span><span class="n">shapeModelTransformationView</span><span class="o">.</span><span class="n">shapeTransformationView</span>
 <span class="n">ssmView</span><span class="o">.</span><span class="n">shapeModelTransformationView</span><span class="o">.</span><span class="n">poseTransformationView</span>

</code></pre></div></div>

<p>The pose transformation and shape transformation are parametric transformations, and to change
the transformation, we can change their parameters. To visualize, for example,  a random shape of the statistical shape model, we can  create a random coefficient vector and set the shape transformation parameters accordingly.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">randCoeffs</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">.</span><span class="n">rand</span><span class="o">[</span><span class="kt">Double</span><span class="o">](</span><span class="n">ssm</span><span class="o">.</span><span class="n">rank</span><span class="o">,</span> <span class="nc">Gaussian</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span>
<span class="n">ssmView</span><span class="o">.</span><span class="n">shapeModelTransformationView</span><span class="o">.</span><span class="n">shapeTransformationView</span><span class="o">.</span><span class="n">coefficients</span> <span class="k">=</span> <span class="n">randCoeffs</span>
</code></pre></div></div>

<p>This will immediately update the shape transformation to the transformation that
is defined by these coefficients and the visualized mesh is deformed accordingly.</p>

<h2 id="visualizing-other-scalismo-objects">Visualizing other scalismo objects</h2>

<p>The concepts that we described above are generic and in exactly the same way
any other scalismo object can be visualized: We use <code class="highlighter-rouge">ui.show</code> to visualize an object and interact with it using the corresponding view object,
which we obtain either directly from the show function, or by using the <code class="highlighter-rouge">ui.filter</code> or
<code class="highlighter-rouge">ui.find</code> method.</p>

<p>Here is, howe we would visualize a 3D image:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">group2</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">createGroup</span><span class="o">(</span><span class="s">"object-2"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">image</span> <span class="k">=</span> <span class="nc">ImageIO</span><span class="o">.</span><span class="n">read3DScalarImage</span><span class="o">[</span><span class="kt">Short</span><span class="o">](</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"./datasets/PaolaMRI.vtk"</span><span class="o">)).</span><span class="n">get</span>
<span class="k">val</span> <span class="n">imageView</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">group2</span><span class="o">,</span> <span class="n">image</span><span class="o">,</span> <span class="s">"mri-image"</span><span class="o">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The following list shows all the scalismo objects, which can currently be visualized
in scalismo-ui.

* 3D image (```DiscreteScalarImage[_3D,_]```)
* 3D vector field (```DiscreteField[_3D, Vector[_3D]]```)
* Point cloud (```IndexedSeq[Point[_3D]]```)
* Landmark (```Landmark[_3D]```)
* Scalar field (```DiscreteScalarField[_3D, _]```)
* Triangle mesh (```TriangleMesh[_3D]```)
* Scalar mesh field(```ScalarMeshField[_]```)
* Line mesh (```LineMesh[_3D]```)
</code></pre></div></div>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scalismo-microsite/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/scalismo-microsite/js/main.js"></script></body></html>