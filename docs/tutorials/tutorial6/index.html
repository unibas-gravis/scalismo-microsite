<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Building a shape model from data | Scalismo</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="0.90"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-0.90"><meta data-react-helmet="true" property="og:title" content="Building a shape model from data | Scalismo"><meta data-react-helmet="true" name="description" content="The goal in this tutorial is to learn how to build a Statistical Shape Model"><meta data-react-helmet="true" property="og:description" content="The goal in this tutorial is to learn how to build a Statistical Shape Model"><meta data-react-helmet="true" property="og:url" content="https://scalismo.org/docs/tutorials/tutorial6"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://scalismo.org/docs/tutorials/tutorial6"><link rel="stylesheet" href="/styles.656a0876.css">
<link rel="preload" href="/styles.0daa2ecb.js" as="script">
<link rel="preload" href="/runtime~main.124dc8b7.js" as="script">
<link rel="preload" href="/main.0069e762.js" as="script">
<link rel="preload" href="/1.d0a04477.js" as="script">
<link rel="preload" href="/88.19909525.js" as="script">
<link rel="preload" href="/90.32728c13.js" as="script">
<link rel="preload" href="/f68ef350.5162599f.js" as="script">
<link rel="preload" href="/87.bdda081e.js" as="script">
<link rel="preload" href="/796e9a81.b8097a4b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Scalismo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img alt="Scalismo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Scalismo</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/onlinecourse">Online courses</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/support">Support</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/unibas-gravis/scalismo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/docs/">0.90</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/tutorials/tutorial6">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/tutorials/tutorial6">0.90</a></li><li><a class="dropdown__link" href="/docs/0.18/tutorials/tutorial6">0.18</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Scalismo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img alt="Scalismo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Scalismo</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/onlinecourse">Online courses</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/unibas-gravis/scalismo" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/support">Support</a></li><li class="menu__list-item"><a class="menu__link" href="/about">About</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/tutorials/tutorial6">Next</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/tutorials/tutorial6">0.90</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.18/tutorials/tutorial6">0.18</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial1">Hello Scalismo!</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial2">Rigid Alignment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial3">From meshes to deformation fields</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial4">Gaussian processes and Point Distribution Models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial5">Gaussian processes, sampling and marginalization</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/tutorials/tutorial6">Building a shape model from data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial7">Shape modelling with Gaussian processes and kernels</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial8">Posterior shape models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial9">Shape completion using GP regression</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial10">Iterative Closest Points for rigid alignment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial11">Model fitting with Iterative Closest Points</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial12">Parametric, non-rigid registration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial13">Active Shape Model Fitting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial14">Model fitting using MCMC - The basic framework</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tutorial15">Model fitting using MCMC - Fitting a shape model</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Others</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/scalismo-ui-introduction">Introduction to Scalismo-ui</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: 0.90</span></div><header><h1 class="docTitle_1Lrw">Building a shape model from data</h1></header><div class="markdown"><p>The goal in this tutorial is to learn how to build a Statistical Shape Model
from meshes in correspondence. Furthermore, we discuss the importance of rigid alignment while doing so.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="related-resources"></a>Related resources<a aria-hidden="true" class="hash-link" href="#related-resources" title="Direct link to heading">#</a></h5><p>The following resources from our <a href="https://www.futurelearn.com/courses/statistical-shape-modelling" target="_blank" rel="noopener noreferrer">online course</a> may provide
some helpful context for this tutorial:</p><ul><li>Learning a model from example data <a href="https://www.futurelearn.com/courses/statistical-shape-modelling/3/steps/250329" target="_blank" rel="noopener noreferrer">(Video)</a></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="preparation"></a>Preparation<a aria-hidden="true" class="hash-link" href="#preparation" title="Direct link to heading">#</a></h5><p>As in the previous tutorials, we start by importing some commonly used objects and initializing the system.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.ui.api._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.geometry._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.common._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.common.interpolation.TriangleMeshInterpolator3D</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.mesh._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.io.{StatisticalModelIO, MeshIO}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.statisticalmodel._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.registration._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.statisticalmodel.dataset._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalismo.numerics.PivotedCholesky.RelativeTolerance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">scalismo.initialize()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">implicit val rng = scalismo.utils.Random(42)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val ui = ScalismoUI()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="loading-and-preprocessing-a-dataset"></a>Loading and preprocessing a dataset:<a aria-hidden="true" class="hash-link" href="#loading-and-preprocessing-a-dataset" title="Direct link to heading">#</a></h3><p>Let us load (and visualize) a set of face meshes based on which we would like to model shape variation:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val dsGroup = ui.createGroup(&quot;datasets&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val meshFiles = new java.io.File(&quot;datasets/nonAlignedFaces/&quot;).listFiles</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val (meshes, meshViews) = meshFiles.map(meshFile =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val mesh = MeshIO.readMesh(meshFile).get</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val meshView = ui.show(dsGroup, mesh, &quot;mesh&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (mesh, meshView) // return a tuple of the mesh and the associated view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}) .unzip // take the tuples apart, to get a sequence of meshes and one of meshViews</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>You immediately see that the meshes are not aligned. What you cannot see, but is
very important for this tutorial, is
that the meshes are <strong>in correspondence</strong>.
This means that for every point on one of the face meshes
(corner of eye, tip of nose, ...), we can identify the corresponding point on
other meshes.  Corresponding points are identified by the same point id.</p><p><em>Exercise: verify that the meshes are indeed in correspondence by displaying a few corresponding points.</em></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="rigidly-aligning-the-data"></a>Rigidly aligning the data:<a aria-hidden="true" class="hash-link" href="#rigidly-aligning-the-data" title="Direct link to heading">#</a></h4><p>In order to study shape variations, we need to eliminate variations due to
relative spatial displacement of the shapes (rotation and translation).
This can be achieved by selecting one of the meshes as a reference,
to which the rest of the datasets are aligned.
In this example here, we simply take the first mesh in the list as a reference and align all the others.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val reference = meshes.head</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val toAlign : IndexedSeq[TriangleMesh[_3D]] = meshes.tail</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Given that our dataset is in correspondence, we can specify a set of point
identifiers, to locate corresponding points on the meshes.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val pointIds = IndexedSeq(2214, 6341, 10008, 14129, 8156, 47775)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val refLandmarks = pointIds.map{id =&gt; Landmark(s&quot;L_$id&quot;, reference.pointSet.point(PointId(id))) }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After locating the landmark positions on the reference, we iterate on each remaining data item, identify the corresponding landmark points and then rigidly align the mesh to the reference.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val alignedMeshes = toAlign.map { mesh =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val landmarks = pointIds.map{id =&gt; Landmark(&quot;L_&quot;+id, mesh.pointSet.point(PointId(id)))}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val rigidTrans = LandmarkRegistration.rigid3DLandmarkRegistration(landmarks, refLandmarks, center = Point(0,0,0))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mesh.transform(rigidTrans)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Now, the IndexedSeq of triangle meshes <em>alignedMeshes</em> contains the faces that are aligned to the reference mesh.</p><p><em>Exercise: verify visually that at least the first element of the aligned dataset is indeed aligned to the reference.</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="building-a-discrete-gaussian-process-from-data"></a>Building a discrete Gaussian process from data<a aria-hidden="true" class="hash-link" href="#building-a-discrete-gaussian-process-from-data" title="Direct link to heading">#</a></h3><p>Now that we have a set of meshes, which are in correspondence and aligned
to our reference, we can turn the dataset into a set of deformation fields,
from which we then build the model:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val defFields = alignedMeshes.map{ m =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val deformationVectors = reference.pointSet.pointIds.map{ id : PointId =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        m.pointSet.point(id) - reference.pointSet.point(id)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }.toIndexedSeq</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    DiscreteField3D(reference, deformationVectors)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Learning the shape variations from this deformation fields is
done by calling the method <code>createUsingPCA</code> of the
<code>DiscreteLowRankGaussianProcess</code> class.
Note that the deformation fields need to be interpolated, such that we are sure that they are defined on
all the points of the reference mesh. Once we have the deformation fields, we can build and
visualize the Point Distribution Model:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val continuousFields = defFields.map(f =&gt; f.interpolate(TriangleMeshInterpolator3D()) )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val gp = DiscreteLowRankGaussianProcess.createUsingPCA(reference,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            continuousFields, RelativeTolerance(1e-8)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val model = PointDistributionModel(gp)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val modelGroup = ui.createGroup(&quot;model&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val ssmView = ui.show(modelGroup, model, &quot;model&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Notice that when we visualize this mesh model in Scalismo-ui,
it generates a GaussianProcessTransformation and the reference mesh in the
Scene Tree of Scalismo-ui.</p><p><em>Exercise: display the mean deformation field of the returned Gaussian Process.</em></p><p><em>Exercise: sample and display a few deformation fields from this GP.</em></p><p><em>Exercise: using the GP&#x27;s </em>cov<em> method, evaluate the sample covariance between two close points on the right cheek first, and a point on the nose and one on the cheek second. What does the data tell you?</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="an-easier-way-to-build-a-model"></a>An easier way to build a model.<a aria-hidden="true" class="hash-link" href="#an-easier-way-to-build-a-model" title="Direct link to heading">#</a></h3><p>Performing all the operations above every time we want to build a PCA model
from a set of files containing meshes in correspondence can be tedious.
Therefore, Scalismo provides a more easy to use implementation via the
<em>DataCollection</em> data structure.</p><p>The <em>DataCollection</em> class in Scalismo allows grouping together a dataset of meshes in correspondence,
in order to make collective operations on such sets easier.</p><p>We can create a <em>DataCollection</em> by providing a reference mesh, and
a sequence of meshes, which are in correspondence with this reference.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val dc = DataCollection.fromTriangleMesh3DSequence(reference, alignedMeshes)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Now that we have our data collection, we can build a shape model as follows:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val modelFromDataCollection = PointDistributionModel.createUsingPCA(dc)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val modelGroup2 = ui.createGroup(&quot;modelGroup2&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ui.show(modelGroup2, modelFromDataCollection, &quot;ModelDC&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>There is a technique called <em>Generalized Procrustes Analysis (GPA)</em>, which can
improve the alignment of the data even better. It works by computing
the mean of a set of surfaces in correspondence, aligning all the surfaces rigidly
to this mean, and then iterating this procedure until the changes in the
computed mean are below a certain threshold. In Scalismo, this alignment
procedure is defined on data collections. We can use it as follows:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-scala codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">val dcWithGPAAlignedShapes = DataCollection.gpa(dc)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val modelFromDataCollectionGPA = PointDistributionModel.createUsingPCA(dcWithGPAAlignedShapes)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">val modelGroup3 = ui.createGroup(&quot;modelGroup3&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ui.show(modelGroup3, modelFromDataCollectionGPA, &quot;ModelDCGPA&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/unibas-gravis/scalismo-microsite/edit/master/website/versioned_docs/version-0.90/tutorials/tutorial6.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/tutorials/tutorial5"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Gaussian processes, sampling and marginalization</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tutorials/tutorial7"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Shape modelling with Gaussian processes and kernels »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#loading-and-preprocessing-a-dataset" class="table-of-contents__link">Loading and preprocessing a dataset:</a></li><li><a href="#building-a-discrete-gaussian-process-from-data" class="table-of-contents__link">Building a discrete Gaussian process from data</a></li><li><a href="#an-easier-way-to-build-a-model" class="table-of-contents__link">An easier way to build a model.</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Tutorial</a></li><li class="footer__item"><a href="http://unibas-gravis.github.io/scalismo/latest/api/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">API-Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://groups.google.com/g/scalismo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum</a></li><li class="footer__item"><a href="https://gitter.im/unibas-gravis/scalismo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter-Chat</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/unibas-gravis/scalismo" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2021 University of Basel. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.0daa2ecb.js"></script>
<script src="/runtime~main.124dc8b7.js"></script>
<script src="/main.0069e762.js"></script>
<script src="/1.d0a04477.js"></script>
<script src="/88.19909525.js"></script>
<script src="/90.32728c13.js"></script>
<script src="/f68ef350.5162599f.js"></script>
<script src="/87.bdda081e.js"></script>
<script src="/796e9a81.b8097a4b.js"></script>
</body>
</html>